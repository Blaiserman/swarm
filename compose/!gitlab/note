docker network create --attachable --driver overlay gitlab

  docker service create \
  --name gitlab-runner-4 \
  --network gitlab \
  --constraint 'node.role == manager' \
  gitlab/gitlab-runner:latest


registration_token=`docker run --rm -t \
--env GITLAB_URL="http://gitlab" \
--env GITLAB_USERNAME="root" \
--env GITLAB_PASSWORD="Password1" \
--network gitlab \
--link "gitlab:gitlab" \
-i dgarros/gitlab-getcitoken`
registration_token=`echo $registration_token | cut -d\ -f4`

docker ps
echo $registration_token

# a tokent secretben t√°rolni?
docker exec -it ea277bde838f \
gitlab-runner register \
--non-interactive \
--tag-list "swarm" \
--name "runner-docker-1" \
--url "http://gitlab" \
--registration-token "kAwadShCVYyGHhZ-PX9R" \
--executor "ssh" \
--ssh-host "192.168.99.100" \
--ssh-user "docker" \
--ssh-password "test"

--name "runner-docker-1" \
--tag-list "docker" \
--docker-links "gitlab:gitlab" \
--docker-image "ruby:2.1"


# .gitlab-ci.yml
stages:
  - test

test:
  stage: test
  script:
    - "hostname"
  tags:
    - swarm

----
https://gist.github.com/boiyaa
https://github.com/JNPRAutomate/gitlab-demo/blob/master/docker.runner.start.sh
